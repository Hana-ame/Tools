import requests
import re
import lxml

def extract_media(url):
  headers = {'User-Agent': 'Mozilla/5.0'}  # 模拟浏览器
  response = requests.get(url, headers=headers)
  # print(response)
  html = response.text
  # print(html)

  # 提取无水印视频地址（需替换转义字符）
  video_match = re.findall(r'(http(?:[^"]*?)mp4)', html)
  # print(video_match) # is a list[str]
  video_url_list = list(map(lambda x: x.replace('\\u002F', '/'), video_match))
  

  # 提取图片地址（示例）
  picture_match = re.findall(r'(http(?:[^"]*?)nd_dft_wlteh_jpg_3)', html)
  # print(picture_match) # is a list[str]
  picture_url_list = list(dict.fromkeys(map(lambda x: x.replace('\\u002F', '/'), picture_match)))
  
  return video_url_list, picture_url_list

if __name__ == '__main__':
  # r = extract_media('http://xhslink.com/m/5HN5I7rxzT3') # ['http://sns-webpic-qc.xhscdn.com/202508181524/b01b12e9974cf6c37dca17be7e97bca2/1040g00831koidba9io005o2r2mvg80ld9c6jflo!nd_prv_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/722a8fa09beee1bde98bee384d9ce2db/1040g00831koidba9io005o2r2mvg80ld9c6jflo!nd_dft_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/b01b12e9974cf6c37dca17be7e97bca2/1040g00831koidba9io005o2r2mvg80ld9c6jflo!nd_prv_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/722a8fa09beee1bde98bee384d9ce2db/1040g00831koidba9io005o2r2mvg80ld9c6jflo!nd_dft_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/b01b12e9974cf6c37dca17be7e97bca2/1040g00831koidba9io005o2r2mvg80ld9c6jflo!nd_prv_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/722a8fa09beee1bde98bee384d9ce2db/1040g00831koidba9io005o2r2mvg80ld9c6jflo!nd_dft_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/b01b12e9974cf6c37dca17be7e97bca2/1040g00831koidba9io005o2r2mvg80ld9c6jflo!nd_prv_wlteh_jpg_3']
  r = extract_media('http://xhslink.com/m/5jyzNHQAHUk') # ([], ['http://sns-webpic-qc.xhscdn.com/202508181524/66d593c1285a9ccfeba60da81e90e333/notes_pre_post/1040g3k831l3c88mi2o005pgubr51otjtkscnnag!nd_prv_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/e87d81c73812017df50726501c072bfa/notes_pre_post/1040g3k831l3c88mi2o005pgubr51otjtkscnnag!nd_dft_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/a5c649cdf1f03344724fd3bb2045cbe6/notes_pre_post/1040g3k831l3c88mi2o0g5pgubr51otjt3ap1fsg!nd_dft_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/43f428159446abd82c8b057a61d8cbfa/notes_pre_post/1040g3k831l3c88mi2o105pgubr51otjt22m6rco!nd_dft_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/d95af4b91f252313cf4e8c19aa76158a/notes_pre_post/1040g3k831l3c88mi2o1g5pgubr51otjt82pcsv8!nd_dft_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/a3936d17d9c15b816fef753f7eca703e/notes_pre_post/1040g3k831l3c88mi2o205pgubr51otjt3lo8e1o!nd_dft_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/66d593c1285a9ccfeba60da81e90e333/notes_pre_post/1040g3k831l3c88mi2o005pgubr51otjtkscnnag!nd_prv_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/66d593c1285a9ccfeba60da81e90e333/notes_pre_post/1040g3k831l3c88mi2o005pgubr51otjtkscnnag!nd_prv_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/e87d81c73812017df50726501c072bfa/notes_pre_post/1040g3k831l3c88mi2o005pgubr51otjtkscnnag!nd_dft_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/e87d81c73812017df50726501c072bfa/notes_pre_post/1040g3k831l3c88mi2o005pgubr51otjtkscnnag!nd_dft_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/66d593c1285a9ccfeba60da81e90e333/notes_pre_post/1040g3k831l3c88mi2o005pgubr51otjtkscnnag!nd_prv_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/80297a753cbf7fc3235df79c8a606481/notes_pre_post/1040g3k831l3c88mi2o0g5pgubr51otjt3ap1fsg!nd_prv_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/80297a753cbf7fc3235df79c8a606481/notes_pre_post/1040g3k831l3c88mi2o0g5pgubr51otjt3ap1fsg!nd_prv_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/a5c649cdf1f03344724fd3bb2045cbe6/notes_pre_post/1040g3k831l3c88mi2o0g5pgubr51otjt3ap1fsg!nd_dft_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/a5c649cdf1f03344724fd3bb2045cbe6/notes_pre_post/1040g3k831l3c88mi2o0g5pgubr51otjt3ap1fsg!nd_dft_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/a958bcc2073eae9f0c4fc8b7409a958e/notes_pre_post/1040g3k831l3c88mi2o105pgubr51otjt22m6rco!nd_prv_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/43f428159446abd82c8b057a61d8cbfa/notes_pre_post/1040g3k831l3c88mi2o105pgubr51otjt22m6rco!nd_dft_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/a958bcc2073eae9f0c4fc8b7409a958e/notes_pre_post/1040g3k831l3c88mi2o105pgubr51otjt22m6rco!nd_prv_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/43f428159446abd82c8b057a61d8cbfa/notes_pre_post/1040g3k831l3c88mi2o105pgubr51otjt22m6rco!nd_dft_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/e27ab2a8fb5e374a8ed525350eb0f6d2/notes_pre_post/1040g3k831l3c88mi2o1g5pgubr51otjt82pcsv8!nd_prv_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/e27ab2a8fb5e374a8ed525350eb0f6d2/notes_pre_post/1040g3k831l3c88mi2o1g5pgubr51otjt82pcsv8!nd_prv_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/d95af4b91f252313cf4e8c19aa76158a/notes_pre_post/1040g3k831l3c88mi2o1g5pgubr51otjt82pcsv8!nd_dft_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/d95af4b91f252313cf4e8c19aa76158a/notes_pre_post/1040g3k831l3c88mi2o1g5pgubr51otjt82pcsv8!nd_dft_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/e93a844ce0282183867182df623c585d/notes_pre_post/1040g3k831l3c88mi2o205pgubr51otjt3lo8e1o!nd_prv_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/a3936d17d9c15b816fef753f7eca703e/notes_pre_post/1040g3k831l3c88mi2o205pgubr51otjt3lo8e1o!nd_dft_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/e93a844ce0282183867182df623c585d/notes_pre_post/1040g3k831l3c88mi2o205pgubr51otjt3lo8e1o!nd_prv_wlteh_jpg_3', 'http://sns-webpic-qc.xhscdn.com/202508181524/a3936d17d9c15b816fef753f7eca703e/notes_pre_post/1040g3k831l3c88mi2o205pgubr51otjt3lo8e1o!nd_dft_wlteh_jpg_3'])
  print(r)